<form id="loanForm">
  <label>
    Loan amount:
    <select name="loanAmountBand" required>
      <option value="10000-15000">$10k–15k</option>
      <option value="15000-20000">$15k–20k</option>
    </select>
  </label>

  <label>
    Lender:
    <input name="lender" required />
  </label>

  <label>
    Interest rate (%):
    <input name="interestRate" type="number" step="0.01" required />
  </label>

  <button type="submit">Submit</button>
</form>

<script>
document.getElementById("loanForm").addEventListener("submit", async (e) => {
  e.preventDefault(); // critical

  const form = e.target;

  const payload = {
    loanAmountBand: form.loanAmountBand.value,
    lender: form.lender.value,
    interestRate: Number(form.interestRate.value)
  };

  try {
    const res = await fetch("/api/submit-car-loan", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    if (!res.ok) {
      const text = await res.text();
      alert("Submit failed: " + text);
      return;
    }

    alert("Submitted successfully");
    form.reset();

  } catch (err) {
    alert("Network error");
    console.error(err);
  }
});
</script>
